a[[i]]<-as.data.frame(a[[i]])[-1]
}else{
a[[i]]<-as.data.frame(design[,3+i])
}
}
a<-as.data.frame(a)
#combine column name with the dataset
colnames(a)<-names_dataset
#Add blocks, task
card<-as.numeric(design[,1])
block<-as.numeric(design[,2])
task<-as.numeric(design[,3])
dat<-a
#insert optout option
if(optout==TRUE){
base<-t(base)
base<-as.matrix(base)
temp<-list()
k<-0
dat_a<-data.frame()
for (i in 1:(sets*nblocks)){
temp[[i]]<-as.matrix(dat[(i+k):(i+nalts-1+k),])
temp[[i]]<-rbind(temp[[i]],base)
k<-k+nalts-1
temp[[i]]<-as.data.frame(temp[[i]])
dat_a<-rbind(dat_a,temp[[i]])
}
q<-as.data.frame(dat_a)
}
#replicate blocks * number of respondents
if(optout==TRUE){
nalts<-nalts+1
dat<-q
}
#create blocks
temp1<-sapply(1:(sets*(nalts)),function(i)(1:nblocks))
temp1<-t(temp1)
temp1<-as.vector(temp1)
dat$block<-temp1
temp<-list()
dat_f<-data.frame()
for (i in 1:nblocks){
temp[[i]]<-do.call(rbind, replicate(nrespondents[i],subset(dat,dat$block==i), simplify=FALSE))
temp[[i]]<-as.data.frame(temp[[i]])
dat_f<-rbind(dat_f,temp[[i]])
}
#add alternatives
dat_f$ALT<-rep(c(1:nalts),sets*sum(nrespondents))
#add responses
resp<-list()
resp_f<-c()
for(i in 1:nblocks){
resp[[i]]<-read_excel(dataset_forms[i])#step1
resp[[i]]<-as.vector(t(resp[[i]][,2:(sets+1)]))
resp[[i]]<-to.dummy(resp[[i]],"resp")
resp[[i]]<-as.vector(t(resp[[i]]))
resp_f<-append(resp_f,resp[[i]])
}
dat_f$resp<-resp_f
#set the final multinomial dataset
for (i in 1:tot_col){
dat_f[,i]=as.numeric(as.character(dat_f[,i]))
}
names<-names(dat_f[,1:tot_col])
names<-append("resp",names)
q<-as.formula(dat_f[,c(names)])
dat_mlogit<-mlogit.data(dat_f, shape="long",choice="resp",alt.var="ALT")
mod<-mlogit(q,data=dat_mlogit)
res<-summary(mod)
return(list(summary=res,dataset=dat_f))
}
#prova 1 (no optout, 2blocks, 5 attributes)
z<-SP_mlogit(attribute_type= c("C","NC","NC","C","NC"),seed=1,cand=expand.grid(delivery_cost = c(3,5,6,10),
delivery_time = c("Same day","2/3 days"),delivery_location=c("Home","Pick-up"),
co2emissions=c(15,100,150,200,300),carrier_drivers_benefits=c("Low","Medium","High")),nalts=2,nblocks=2,sets=10,
dataset_forms=c("C:/Users/utente/Downloads/Block 1 DELIVERY (Risposte) (6).xlsx",
"C:/Users/utente/Downloads/_Block 2 DELIVERY (Risposte) (5).xlsx"),
nrespondents=c(7,1),optout=FALSE)
z$summary$coefficients
z$summary
z
library(SP.Survey)
#prova 1 (no optout, 2blocks, 5 attributes)
z<-SP_mlogit(attribute_type= c("C","NC","NC","C","NC"),seed=1,cand=expand.grid(delivery_cost = c(3,5,6,10),
delivery_time = c("Same day","2/3 days"),delivery_location=c("Home","Pick-up"),
co2emissions=c(15,100,150,200,300),carrier_drivers_benefits=c("Low","Medium","High")),nalts=2,nblocks=2,sets=10,
dataset_forms=c("C:/Users/utente/Downloads/Block 1 DELIVERY (Risposte) (6).xlsx",
"C:/Users/utente/Downloads/_Block 2 DELIVERY (Risposte) (5).xlsx"),
nrespondents=c(7,1),optout=FALSE)
z
SP_mlogit<-function(attribute_type,seed,cand,nalts,nblocks,sets,
dataset_forms,nrespondents,optout,base=NULL){
library(choiceDes)
library(varhandle)
library(readxl)
library(mlogit)
library(logitr)
#error control
for (i in 1:length(cand[1,])){
if(attribute_type[i]!="C"&attribute_type[i]!="NC"){
stop("INSERT AS ATTRIBUTE TYPE C OR NC")
}
}
if (class(nalts)!="numeric"|class(nblocks)!="numeric"|class(sets)!="numeric"|class(nalts)!="numeric"|class(nblocks)!="numeric"|class(seed)!="numeric"){
stop("INSERT a numeric value of nalts/nblocks/sets/seed")
}
if(length(nrespondents)!=nblocks){
stop("nrespondents parameter must have the same length of the parameter nblocks")
}
if(class(nrespondents)!="numeric"){
stop("nrespondents parameter must be numeric")
}
if(class(cand)!="data.frame"){
stop("parameter cand must have class data.frame ")
}
if(length(cand[1,])<=1|length(cand[1,])>5){
stop("insert a candidate design matrix with length >1 and <=5")
}
if(length(cand[1,])!=length(attribute_type)){
stop("parameter cand and attribute_type must have the same length")
}
if(is.null(base)==TRUE&optout==TRUE){
stop("set the parameter optout as FALSE or if it must be TRUE insert the parameter BASE")
}
if(is.null(base)==FALSE&optout==FALSE){
stop("delete the parameter base or set the parameter optout as TRUE")
}
if (nalts==1&optout==FALSE){
stop("insert more than 1 alternative or set the parameter optout as TRUE")
}
#set the seed
set.seed(seed)
#names creation
tot_col<-0
for (i in 1:length(cand[1,])){
print(i)
if (attribute_type[i]=="NC"){
tot_col<-(length(levels(factor(cand[,i])))-1)+tot_col
}else{
tot_col<-tot_col+1
}
}
names_dataset<-rep("name",tot_col)
temp<-list()
z<-0
for (i in 1:length(attribute_type)){
if(attribute_type[i]=="NC"){
temp[[i]]<-paste(names(cand[1,])[i],levels(factor(cand[,i]))[-1],sep="_")
}else{
temp[[i]]<-names(cand[1,])[i]
}
}
names_dataset<-unlist(temp)
#create experimental design matrix
design <- dcm.design.cand(cand=cand, sets=sets, nb=nblocks, alts=nalts)
design<-design$levels
for (i in 1:length(cand[1,])){
colnames(design)[3+i]=names(cand)[i]
}
#dataset creation->column creation
a<-list()
for(i in 1:length(cand[1,])){
if(attribute_type[i]=="NC"){
a[[i]]<-to.dummy(design[,3+i],prefix=names(design)[3+i])
a[[i]]<-as.data.frame(a[[i]])[-1]
}else{
a[[i]]<-as.data.frame(design[,3+i])
}
}
a<-as.data.frame(a)
#combine column name with the dataset
colnames(a)<-names_dataset
#Add blocks, task
card<-as.numeric(design[,1])
block<-as.numeric(design[,2])
task<-as.numeric(design[,3])
dat<-a
#insert optout option
if(optout==TRUE){
base<-t(base)
base<-as.matrix(base)
temp<-list()
k<-0
dat_a<-data.frame()
for (i in 1:(sets*nblocks)){
temp[[i]]<-as.matrix(dat[(i+k):(i+nalts-1+k),])
temp[[i]]<-rbind(temp[[i]],base)
k<-k+nalts-1
temp[[i]]<-as.data.frame(temp[[i]])
dat_a<-rbind(dat_a,temp[[i]])
}
q<-as.data.frame(dat_a)
}
#replicate blocks * number of respondents
if(optout==TRUE){
nalts<-nalts+1
dat<-q
}
#create blocks
temp1<-sapply(1:(sets*(nalts)),function(i)(1:nblocks))
temp1<-t(temp1)
temp1<-as.vector(temp1)
dat$block<-temp1
temp<-list()
dat_f<-data.frame()
for (i in 1:nblocks){
temp[[i]]<-do.call(rbind, replicate(nrespondents[i],subset(dat,dat$block==i), simplify=FALSE))
temp[[i]]<-as.data.frame(temp[[i]])
dat_f<-rbind(dat_f,temp[[i]])
}
#add alternatives
dat_f$ALT<-rep(c(1:nalts),sets*sum(nrespondents))
#add responses
resp<-list()
resp_f<-c()
for(i in 1:nblocks){
resp[[i]]<-read_excel(dataset_forms[i])#step1
resp[[i]]<-as.vector(t(resp[[i]][,2:(sets+1)]))
resp[[i]]<-to.dummy(resp[[i]],"resp")
resp[[i]]<-as.vector(t(resp[[i]]))
resp_f<-append(resp_f,resp[[i]])
}
dat_f$resp<-resp_f
#set the final multinomial dataset
for (i in 1:tot_col){
dat_f[,i]=as.numeric(as.character(dat_f[,i]))
}
names<-names(dat_f[,1:tot_col])
names<-append("resp",names)
q<-as.formula(dat_f[,c(names)])
dat_mlogit<-mlogit.data(dat_f, shape="long",choice="resp",alt.var="ALT")
mod<-mlogit(q,data=dat_mlogit)
res<-summary(mod)
return(list(summary=res,dataset=dat_f))
}
#prova 1 (no optout, 2blocks, 5 attributes)
z<-SP_mlogit(attribute_type= c("C","NC","NC","C","NC"),seed=1,cand=expand.grid(delivery_cost = c(3,5,6,10),
delivery_time = c("Same day","2/3 days"),delivery_location=c("Home","Pick-up"),
co2emissions=c(15,100,150,200,300),carrier_drivers_benefits=c("Low","Medium","High")),nalts=2,nblocks=2,sets=10,
dataset_forms=c("C:/Users/utente/Downloads/Block 1 DELIVERY (Risposte) (6).xlsx",
"C:/Users/utente/Downloads/_Block 2 DELIVERY (Risposte) (5).xlsx"),
nrespondents=c(7,1),optout=FALSE)
z
k<-partworth_utility(coefficients=z$summary$coefficients,cand=expand.grid(delivery_cost = c("3","5","6","10"),
delivery_time = c("Same day","2/3 days"),location=c("Home","Pick-up"),
co2emissions=c(15,100,150,200,300),carrier_drivers_benefits=c("Low","Medium","High")
),nalts=2,
optout=FALSE,attribute_type = c("C","NC","NC","C","NC"))
#SCENARIO
f<-SP_market_demand(z$summary$coefficients,optout=FALSE,base=c(5,1,0,300,0,0),
simulations=data.frame(6,0,1,seq(15,300,by=1),0,0),c.var=4,nalts=2,xlab="co2emissions",ylab="market demand",type="l")
z<-SP_mlogit(attribute_type= c("C","NC","NC","C","NC"),seed=1,cand=expand.grid(delivery_cost = c(3,5,6,10),
delivery_time = c("Same day","2/3 days"),delivery_location=c("Home","Pick-up"),
co2emissions=c(15,100,150,200,300),carrier_drivers_benefits=c("Low","Medium","High")),nalts=2,nblocks=2,sets=10,
dataset_forms=c("C:/Users/utente/Downloads/Block 1 DELIVERY_optout (Responses).xlsx",
"C:/Users/utente/Downloads/Block 2 DELIVERY_optout (Responses).xlsx"),
nrespondents=c(1,1),optout=TRUE,base=c(0,0,0,0,0,0))
#partworth utility
k<-partworth_utility(coefficients=z$summary$coefficients,cand=expand.grid(delivery_cost = c(3,5,6,10),
delivery_time = c("Same day","2/3 days"),location=c("Home","Pick-up"),
co2emissions=c(15,100,150,200,300),
carrier_drivers_benefits=c("Low","Medium","High")),nalts=2,optout=TRUE,
attribute_type = c("C","NC","NC","C","NC")
)
f<-SP_market_demand(q$multinomial_logit_estimation$coefficients,optout=TRUE,base=c(0,0,0,0,0,0),
simulations=data.frame(6,0,1,seq(15,300,by=1),0,0),c.var=4,nalts=2,xlab="co2emissions",ylab="market demand",type="l")
z<-logit_coeff(sets=5,nalts=2,nblocks=6,seed=1,cand=expand.grid(delivery_cost = c(3,5,6,10),
delivery_time = c("Same day","2/3 days"),delivery_location=c("Home","Pick-up")
),attribute_type = c("NC","NC","NC"),
dataset_forms=c("C:/Users/utente/Downloads/ATTEMPT 1.xlsx",
"C:/Users/utente/Downloads/ATTEMP 2.xlsx",
"C:/Users/utente/Downloads/ATTEMPT 3.xlsx",
"C:/Users/utente/Downloads/ATTEMPT 4.xlsx",
"C:/Users/utente/Downloads/ATTEMPT 5.xlsx",
"C:/Users/utente/Downloads/ATTEMPT 6.xlsx"),
nrespondents=c(1,1,1,1,1,1),optout=FALSE)
z<-SP_mlogit(sets=5,nalts=2,nblocks=6,seed=1,cand=expand.grid(delivery_cost = c(3,5,6,10),
delivery_time = c("Same day","2/3 days"),delivery_location=c("Home","Pick-up")
),attribute_type = c("NC","NC","NC"),
dataset_forms=c("C:/Users/utente/Downloads/ATTEMPT 1.xlsx",
"C:/Users/utente/Downloads/ATTEMP 2.xlsx",
"C:/Users/utente/Downloads/ATTEMPT 3.xlsx",
"C:/Users/utente/Downloads/ATTEMPT 4.xlsx",
"C:/Users/utente/Downloads/ATTEMPT 5.xlsx",
"C:/Users/utente/Downloads/ATTEMPT 6.xlsx"),
nrespondents=c(1,1,1,1,1,1),optout=FALSE)
#partworth utilities
k<-partworth_utility(coefficients=z$summary$coefficients,cand=expand.grid(delivery_cost = c(3,5,6,10),
delivery_time = c("Same day","2/3 days"),location=c("Home","Pick-up")),nalts=2,optout=FALSE,
attribute_type = c("NC","NC","NC"))
#scenario
f<-SP_market_demand(z$summary$coefficients,optout=FALSE,base=c(0,0,0,0,0),
simulations=data.frame(c(0,1),0,0,0,0),c.var=1,nalts=2,xlab="co2emissions",ylab="market demand",type="l")
z<-SP_mlogit(sets=5,nalts=2,nblocks=3,seed=1,cand=expand.grid(delivery_cost = c("3","5","6","10"),
delivery_time = c("Same day","2/3 days"),delivery_location=c("Home","Pick-up")
),attribute_type = c("NC","NC","NC"),
dataset_forms=c("C:/Users/utente/OneDrive - Universita degli Studi Roma Tre (1)/TRElab/projects/digital society/optout1.xlsx",
"C:/Users/utente/OneDrive - Universita degli Studi Roma Tre (1)/TRElab/projects/digital society/optout2.xlsx",
"C:/Users/utente/Downloads/optout3.xlsx"),
nrespondents=c(1,1,1),optout=TRUE, base=c(0,0,0,0,0))
k<-partworth_utility(coefficients=z$summary$coefficients,cand=expand.grid(delivery_cost = c(3,5,6,10),
delivery_time = c("Same day","2/3 days"),location=c("Home","Pick-up")),nalts=2,optout=TRUE,
attribute_type = c("NC","NC","NC"))
#scenario
f<-SP_market_demand(z$summary$coefficients,optout=TRUE,base=c(0,0,0,0,0),
simulations=data.frame(c(0,1),0,0,0,0),c.var=1,nalts=2,xlab="co2emissions",ylab="market demand",type="l")
z<-SP_mlogit(attribute_type= c("C","NC","NC","C","NC"),seed=1,cand=expand.grid(delivery_cost = c("3","5","6","10"),
delivery_time = c("Same day","2/3 days"),delivery_location=c("Home","Pick-up"),
co2emissions=c("15","100","150","200","300"),carrier_drivers_benefits=c("Low","Medium","High")),nalts=2,nblocks=2,sets=10,
dataset_forms=c("C:/Users/utente/Downloads/Block 1 DELIVERY (Risposte) (5).xlsx",
"C:/Users/utente/Downloads/_Block 2 DELIVERY (Risposte) (4).xlsx"),
nrespondents=c(3,1),optout=FALSE)
z
partworth_utility_basic<-function(coefficients,data,nalts,optout,attribute_type){
library(RColorBrewer)
#error control
if (class(nalts)!="numeric"){
stop("INSERT a numeric value of nalts")
}
for (i in 1:(length(data)-2)){
if(attribute_type[i]!="C"&attribute_type[i]!="NC"){
stop("INSERT AS ATTRIBUTE TYPE C OR NC")
}
}
if (nalts==1&optout==FALSE){
stop("insert more than 1 alternative or set the parameter optout as TRUE")
}
###################################
if(optout==TRUE){
nalts=nalts+1
}
coefficients=coefficients[-c(1:(nalts-1))]
vector<-names(coefficients)
partworth<-coefficients
partworth<-cbind(partworth,vector)
partworth_final<-rep(0,length(attribute_type))
j<-0
for (i in 1:length(attribute_type)){
if (attribute_type[i]=="NC"){
partworth_final[i]=max(as.numeric(partworth[(i+j):(i+j+length(levels(as.factor(as.matrix(data[,i]))))-2),1]),0)-min(as.numeric(partworth[(i+j):(i+j+length(levels(as.factor(as.matrix(data[,i]))))-2),1]),0)
j<-j+length(levels(as.factor(as.matrix(data[,i]))))-2
}else{
partworth_final[i]<-(max(as.numeric(levels(as.factor(as.matrix(data[,i])))))-min(as.numeric(levels(as.factor(as.matrix(data[,i]))))))*abs(as.numeric(partworth[i+j,1]))
}
}
sum<-sum(partworth_final)
for (i in 1: length(attribute_type)){
partworth_final[i]<-(partworth_final[i])/sum
}
partworth_final<-round(partworth_final,digits=3)*100
z<-barplot(partworth_final,names.arg=names(data[,1:length(attribute_type)]),col=brewer.pal(n =length(attribute_type), name = "RdBu"),horiz=FALSE,main="Partworth utilities",cex.names=1.2)
p<-paste(partworth_final,"%")
q<-text(z,partworth_final-1.2,labels=p,cex=1.5)
return (list(partworth_utility=partworth_final))
}
z<-SP_mlogit(sets=10,nalts=2,nblocks=2,seed=1,cand=expand.grid(delivery_cost = c(3,5,6,10),
delivery_time = c("Same day","2/3 days"),delivery_location=c("Home","Pick-up"),
co2emissions=c(15,100,150,200,300),carrier_drivers_benefits=c("Low","Medium","High"))
,attribute_type = c("NC","NC","NC","NC","NC"),
dataset_forms=c("C:/Users/utente/Downloads/Block 1 DELIVERY (Risposte) (6).xlsx",
"C:/Users/utente/Downloads/_Block 2 DELIVERY (Risposte) (5).xlsx"),
nrespondents=c(7,1),optout=FALSE)
#scenario analysis
f<-SP_market_demand(z$multinomial_logit_estimation$coefficients,optout=FALSE,base=c(5,1,0,300,0,0),
simulations=data.frame(6,0,1,seq(15,300,by=1),0,0),c.var=4,nalts=2,xlab="co2emissions",ylab="market demand",type="l")
#scenario analysis
f<-SP_market_demand(z$summary,optout=FALSE,base=c(5,1,0,300,0,0),
simulations=data.frame(6,0,1,seq(15,300,by=1),0,0),c.var=4,nalts=2,xlab="co2emissions",ylab="market demand",type="l")
z<-SP_mlogit(sets=10,nalts=2,nblocks=2,seed=1,cand=expand.grid(delivery_cost = c(3,5,6,10),
delivery_time = c("Same day","2/3 days"),delivery_location=c("Home","Pick-up"),
co2emissions=c(15,100,150,200,300),carrier_drivers_benefits=c("Low","Medium","High"))
,attribute_type = c("C","NC","NC","C","NC"),
dataset_forms=c("C:/Users/utente/Downloads/Block 1 DELIVERY (Risposte) (6).xlsx",
"C:/Users/utente/Downloads/_Block 2 DELIVERY (Risposte) (5).xlsx"),
nrespondents=c(7,1),optout=FALSE)
#scenario analysis
f<-SP_market_demand(z$summary,optout=FALSE,base=c(5,1,0,300,0,0),
simulations=data.frame(6,0,1,seq(15,300,by=1),0,0),c.var=4,nalts=2,xlab="co2emissions",ylab="market demand",type="l")
library(SP.Survey)
z<-SP_mlogit(sets=10,nalts=2,nblocks=2,seed=1,cand=expand.grid(delivery_cost = c(3,5,6,10),
delivery_time = c("Same day","2/3 days"),delivery_location=c("Home","Pick-up"),
co2emissions=c(15,100,150,200,300),carrier_drivers_benefits=c("Low","Medium","High"))
,attribute_type = c("C","NC","NC","C","NC"),
dataset_forms=c("C:/Users/utente/Downloads/Block 1 DELIVERY (Risposte) (6).xlsx",
"C:/Users/utente/Downloads/_Block 2 DELIVERY (Risposte) (5).xlsx"),
nrespondents=c(7,1),optout=FALSE)
z$summary
#scenario analysis
f<-SP_market_demand(z$summary$coefficients,optout=FALSE,base=c(5,1,0,300,0,0),
simulations=data.frame(6,0,1,seq(15,300,by=1),0,0),c.var=4,nalts=2,xlab="co2emissions",ylab="market demand",type="l")
#partworth utility
k<-partworth_utility(coefficients=z$multinomial_logit_estimation$coefficients,cand=expand.grid(delivery_cost = c(3,5,6,10),
delivery_time = c("Same day","2/3 days"),location=c("Home","Pick-up"),
co2emissions=c(15,100,150,200,300),carrier_drivers_benefits=c("Low","Medium","High")
),nalts=2,
optout=FALSE,attribute_type = c("C","NC","NC","C","NC"))
#partworth utility
k<-partworth_utility(coefficients=z$summary$coefficients,cand=expand.grid(delivery_cost = c(3,5,6,10),
delivery_time = c("Same day","2/3 days"),location=c("Home","Pick-up"),
co2emissions=c(15,100,150,200,300),carrier_drivers_benefits=c("Low","Medium","High")
),nalts=2,
optout=FALSE,attribute_type = c("C","NC","NC","C","NC"))
#prova basic function mlogit
z<-SP_mlogit_basic(dataset=retailers_freight,attribute_type = c("NC","C","C"))
#PROVA partworth utilities
q<-partworth_utility_basic(z$coefficients,data=retailers_freight,nalts=2,optout=TRUE,attribute_type = c("NC","C","C"))
#prova sceario
f<-SP_market_demand(coefficients=z$coefficients,optout=TRUE,base=c(0,0,10,600),simulations=data.frame(0,0,10,seq(200,2000,by=0.1)),type="l",
xlab="tariffa",ylab="market demand",nalts=2,c.var=4)
library(SP.Survey)
library(SP.Survey)
library(SP.Survey)
#prova 1 (no optout, 2blocks, 5 attributes)
z<-SP_mlogit(attribute_type= c("C","NC","NC","C","NC"),seed=1,cand=expand.grid(delivery_cost = c(3,5,6,10),
delivery_time = c("Same day","2/3 days"),delivery_location=c("Home","Pick-up"),
co2emissions=c(15,100,150,200,300),carrier_drivers_benefits=c("Low","Medium","High")),nalts=2,nblocks=2,sets=10,
dataset_forms=c("C:/Users/utente/Downloads/Block 1 DELIVERY (Risposte) (6).xlsx",
"C:/Users/utente/Downloads/_Block 2 DELIVERY (Risposte) (5).xlsx"),
nrespondents=c(7,1),optout=FALSE)
z
k<-partworth_utility(coefficients=z$summary$coefficients,cand=expand.grid(delivery_cost = c("3","5","6","10"),
delivery_time = c("Same day","2/3 days"),location=c("Home","Pick-up"),
co2emissions=c(15,100,150,200,300),carrier_drivers_benefits=c("Low","Medium","High")
),nalts=2,
optout=FALSE,attribute_type = c("C","NC","NC","C","NC"))
f<-SP_market_demand(z$summary$coefficients,optout=FALSE,base=c(5,1,0,300,0,0),
simulations=data.frame(6,0,1,seq(15,300,by=1),0,0),c.var=4,nalts=2,xlab="co2emissions",ylab="market demand",type="l")
z<-SP_mlogit(attribute_type= c("C","NC","NC","C","NC"),seed=1,cand=expand.grid(delivery_cost = c(3,5,6,10),
delivery_time = c("Same day","2/3 days"),delivery_location=c("Home","Pick-up"),
co2emissions=c(15,100,150,200,300),carrier_drivers_benefits=c("Low","Medium","High")),nalts=2,nblocks=2,sets=10,
dataset_forms=c("C:/Users/utente/Downloads/Block 1 DELIVERY_optout (Responses).xlsx",
"C:/Users/utente/Downloads/Block 2 DELIVERY_optout (Responses).xlsx"),
nrespondents=c(1,1),optout=TRUE,base=c(0,0,0,0,0,0))
#partworth utility
k<-partworth_utility(coefficients=z$summary$coefficients,cand=expand.grid(delivery_cost = c(3,5,6,10),
delivery_time = c("Same day","2/3 days"),location=c("Home","Pick-up"),
co2emissions=c(15,100,150,200,300),
carrier_drivers_benefits=c("Low","Medium","High")),nalts=2,optout=TRUE,
attribute_type = c("C","NC","NC","C","NC")
)
##################################
#scenario analysis
f<-SP_market_demand(q$multinomial_logit_estimation$coefficients,optout=TRUE,base=c(0,0,0,0,0,0),
simulations=data.frame(6,0,1,seq(15,300,by=1),0,0),c.var=4,nalts=2,xlab="co2emissions",ylab="market demand",type="l")
z<-SP_mlogit(sets=5,nalts=2,nblocks=6,seed=1,cand=expand.grid(delivery_cost = c(3,5,6,10),
delivery_time = c("Same day","2/3 days"),delivery_location=c("Home","Pick-up")
),attribute_type = c("NC","NC","NC"),
dataset_forms=c("C:/Users/utente/Downloads/ATTEMPT 1.xlsx",
"C:/Users/utente/Downloads/ATTEMP 2.xlsx",
"C:/Users/utente/Downloads/ATTEMPT 3.xlsx",
"C:/Users/utente/Downloads/ATTEMPT 4.xlsx",
"C:/Users/utente/Downloads/ATTEMPT 5.xlsx",
"C:/Users/utente/Downloads/ATTEMPT 6.xlsx"),
nrespondents=c(1,1,1,1,1,1),optout=FALSE)
#partworth utilities
k<-partworth_utility(coefficients=z$summary$coefficients,cand=expand.grid(delivery_cost = c(3,5,6,10),
delivery_time = c("Same day","2/3 days"),location=c("Home","Pick-up")),nalts=2,optout=FALSE,
attribute_type = c("NC","NC","NC"))
#scenario
f<-SP_market_demand(z$summary$coefficients,optout=FALSE,base=c(0,0,0,0,0),
simulations=data.frame(c(0,1),0,0,0,0),c.var=1,nalts=2,xlab="co2emissions",ylab="market demand",type="l")
install.packages("C:/Users/utente/OneDrive - Universita degli Studi Roma Tre/Desktop/Prova/SP.Survey_0.1.0.tar.gz", repos = NULL, type = "source")
#prova 1 (no optout, 2blocks, 5 attributes)
z<-SP_mlogit(attribute_type= c("C","NC","NC","C","NC"),seed=1,cand=expand.grid(delivery_cost = c(3,5,6,10),
delivery_time = c("Same day","2/3 days"),delivery_location=c("Home","Pick-up"),
co2emissions=c(15,100,150,200,300),carrier_drivers_benefits=c("Low","Medium","High")),nalts=2,nblocks=2,sets=10,
dataset_forms=c("C:/Users/utente/Downloads/Block 1 DELIVERY (Risposte) (6).xlsx",
"C:/Users/utente/Downloads/_Block 2 DELIVERY (Risposte) (5).xlsx"),
nrespondents=c(7,1),optout=FALSE)
z
k<-partworth_utility(coefficients=z$summary$coefficients,cand=expand.grid(delivery_cost = c("3","5","6","10"),
delivery_time = c("Same day","2/3 days"),location=c("Home","Pick-up"),
co2emissions=c(15,100,150,200,300),carrier_drivers_benefits=c("Low","Medium","High")
),nalts=2,
optout=FALSE,attribute_type = c("C","NC","NC","C","NC"))
#SCENARIO
f<-SP_market_demand(z$summary$coefficients,optout=FALSE,base=c(5,1,0,300,0,0),
simulations=data.frame(6,0,1,seq(15,300,by=1),0,0),c.var=4,nalts=2,xlab="co2emissions",ylab="market demand",type="l")
z<-SP_mlogit(attribute_type= c("C","NC","NC","C","NC"),seed=1,cand=expand.grid(delivery_cost = c(3,5,6,10),
delivery_time = c("Same day","2/3 days"),delivery_location=c("Home","Pick-up"),
co2emissions=c(15,100,150,200,300),carrier_drivers_benefits=c("Low","Medium","High")),nalts=2,nblocks=2,sets=10,
dataset_forms=c("C:/Users/utente/Downloads/Block 1 DELIVERY_optout (Responses).xlsx",
"C:/Users/utente/Downloads/Block 2 DELIVERY_optout (Responses).xlsx"),
nrespondents=c(1,1),optout=TRUE,base=c(0,0,0,0,0,0))
#partworth utility
k<-partworth_utility(coefficients=z$summary$coefficients,cand=expand.grid(delivery_cost = c(3,5,6,10),
delivery_time = c("Same day","2/3 days"),location=c("Home","Pick-up"),
co2emissions=c(15,100,150,200,300),
carrier_drivers_benefits=c("Low","Medium","High")),nalts=2,optout=TRUE,
attribute_type = c("C","NC","NC","C","NC")
)
#prova 4 (optout e 3blocks, 3 attributes)
z<-SP_mlogit(sets=5,nalts=2,nblocks=3,seed=1,cand=expand.grid(delivery_cost = c("3","5","6","10"),
delivery_time = c("Same day","2/3 days"),delivery_location=c("Home","Pick-up")
),attribute_type = c("NC","NC","NC"),
dataset_forms=c("C:/Users/utente/OneDrive - Universita degli Studi Roma Tre (1)/TRElab/projects/digital society/optout1.xlsx",
"C:/Users/utente/OneDrive - Universita degli Studi Roma Tre (1)/TRElab/projects/digital society/optout2.xlsx",
"C:/Users/utente/Downloads/optout3.xlsx"),
nrespondents=c(1,1,1),optout=TRUE, base=c(0,0,0,0,0))
z
#prova 3 (no optout 3, blocks=6, 3 attributes)
z<-SP_mlogit(sets=5,nalts=2,nblocks=6,seed=1,cand=expand.grid(delivery_cost = c(3,5,6,10),
delivery_time = c("Same day","2/3 days"),delivery_location=c("Home","Pick-up")
),attribute_type = c("NC","NC","NC"),
dataset_forms=c("C:/Users/utente/Downloads/ATTEMPT 1.xlsx",
"C:/Users/utente/Downloads/ATTEMP 2.xlsx",
"C:/Users/utente/Downloads/ATTEMPT 3.xlsx",
"C:/Users/utente/Downloads/ATTEMPT 4.xlsx",
"C:/Users/utente/Downloads/ATTEMPT 5.xlsx",
"C:/Users/utente/Downloads/ATTEMPT 6.xlsx"),
nrespondents=c(1,1,1,1,1,1),optout=FALSE)
z
